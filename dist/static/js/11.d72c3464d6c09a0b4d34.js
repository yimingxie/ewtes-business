webpackJsonp([11],{SCiK:function(t,a){},vqrb:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("n5Qe"),s=(e("XAb4"),e("s6tw")),l={data:function(){return{facility:"",partPoint:"",ruleForm:{epedName:"",inNum:"",localArea:"",areaCode:"",address:"",latLon:"",checkPoint:[]},rules:{epedName:[{required:!0,message:"必填",trigger:"blur"}],inNum:[{required:!0,message:"必填",trigger:"blur"}],areaCode:[{required:!0,message:"必填",trigger:"change"}],address:[{required:!0,message:"必填",trigger:"blur"}]},special:{areaCode:[],lng:"",lat:""},pointDataOptions:[{value:1,label:"身份证+温度"},{value:2,label:"人脸+温度"},{value:3,label:"人脸+温度+身份证"}],checkPoint:[],dialogAddCheckPoint:!1,ruleFormCheckPoint:{pointName:"",pointData:[],pointDataCN:""},rulesCheckPoint:{},checkPointDataArr:[]}},created:function(){this.facility=localStorage.getItem("facility")?parseInt(localStorage.getItem("facility")):100,this.partPoint=localStorage.getItem("partPoint")?parseInt(localStorage.getItem("partPoint")):100},mounted:function(){this.searchMap()},methods:{searchMap:function(t){var a,e,i=this;e="theme2"==(localStorage.getItem("theme")?localStorage.getItem("theme"):"theme1")?"amap://styles/85ed8cccf4c51fa1c36fd40d443619eb":"amap://styles/db9065b28cc027a6a3240fc2ae093125";var s=new AMap.Map("map-container",{resizeEnable:!0,zoom:20,mapStyle:e});function l(t,e,l){(a=new AMap.Marker({map:s,content:'\n          <div class="point" id="pp">\n            <div class="point-light"></div>\n            <div class="point-circle"></div>\n          </div>\n          ',position:[t,e],draggable:!0})).setMap(s),i.special.lng=t,i.special.lat=e,a.on("dragging",function(t){i.special.lng=t.lnglat.lng,i.special.lat=t.lnglat.lat})}if(l(s.getCenter().lng,s.getCenter().lat),a.on("mousedown",function(){document.getElementById("point-tip").style.display="none"}),t){var o=t.split(",")[0],n=t.split(",")[1];return l(o,n),void s.setCenter([o,n])}this.ruleForm.localArea,this.ruleForm.address;var c=new AMap.Autocomplete({input:"address"});AMap.event.addListener(c,"select",function(t){s.clearMap(),s.setZoomAndCenter(20,[t.poi.location.lng,t.poi.location.lat]),l(t.poi.location.lng,t.poi.location.lat),i.ruleForm.address=t.poi.name,i.special.areaCode=i.transformAreaCode(t.poi.adcode),i.ruleForm.areaCode=i.special.areaCode[i.special.areaCode.length-1]||"";i.ruleForm.localArea=t.poi.district.match(/.+?(省|市|自治区|自治州|县|区)/g).join("/"),setTimeout(function(){i.$refs.laForm.clearValidate("areaCode")},100)}),s.on("click",function(t){s.clearMap(),i.special.lng=t.lnglat.lng,i.special.lat=t.lnglat.lat,l(t.lnglat.lng,t.lnglat.lat)})},transformAreaCode:function(t){if("string"==typeof t){var a=t.substr(0,2),e=t.substr(0,4),i=t.substr(0,6),s=t.substr(0,9),l=[];return t.length<=2?l.push(a):t.length>2&&t.length<=4?l.push(a,e):t.length>4&&t.length<=6?l.push(a,e,i):l.push(a,e,i,s),l}if(t instanceof Array)return t[t.length-1]},getCity:function(t,a){this.ruleForm.areaCode=t[t.length-1]||"",this.special.areaCode=t,this.ruleForm.localArea=a.join("/")},checkPointDelete:function(t){this.checkPoint.splice(t,1)},clearRuleFormCheckPoint:function(){this.ruleFormCheckPoint={pointName:"",pointData:"",pointDataCN:""},this.checkPointDataArr=[]},openDialogAddCheckPoint:function(){if(this.checkPoint.length>=this.partPoint)return this.$message.error("剩余可添加检测区域0");this.checkPoint.push({pointName:"",pointData:[],pointDataCN:""})},closeDialogAddCheckPoint:function(){this.clearRuleFormCheckPoint(),this.dialogAddCheckPoint=!1},saveCheckPoint:function(){if(0===this.checkPointDataArr.length||""===this.ruleFormCheckPoint.pointName)return this.$message.error("检测区域请填写完整");this.checkPoint.push(this.ruleFormCheckPoint),this.closeDialogAddCheckPoint()},formPointDataChange:function(){var t=[];this.checkPointDataArr.length>0&&this.checkPointDataArr.forEach(function(a,e){1==a?t.push("身份证+温度"):2==a?t.push("人脸+温度"):3==a&&t.push("人脸+温度+身份证")}),this.ruleFormCheckPoint.pointDataCN=t.join("，"),this.ruleFormCheckPoint.pointData=this.checkPointDataArr},listPointDataChange:function(t){var a=[];this.checkPoint[t].pointData.length>0&&this.checkPoint[t].pointData.forEach(function(t){1==t?a.push("身份证+温度"):2==t?a.push("人脸+温度"):3==t&&a.push("人脸+温度+身份证")}),this.checkPoint[t].pointDataCN=a.join("，")},submit:function(){var t=this,a=this;this.$refs.laForm.validate(function(e){if(e){var s=t.special.lng||"",l=t.special.lat||"";if(t.ruleForm.latLon=s&&l?s+","+l:"",!t.special.lng||!t.special.lat)return t.$message.error("请点击地图确定电梯具体位置");var o={epedName:t.ruleForm.epedName,inNum:t.ruleForm.inNum,localArea:t.ruleForm.localArea,areaCode:t.ruleForm.areaCode,address:t.ruleForm.address,latLon:t.ruleForm.latLon,checkPoint:[]},n=[];if(0===t.checkPoint.length)return t.$message.error("检测区域请填写完整");t.checkPoint.forEach(function(t){n.push({pointName:t.pointName,pointData:t.pointData.join("|")})}),o.checkPoint=n,i.a.digital.addEpidemic(o).then(function(t){200==t.data.code?(a.$message.success("添加成功"),a.$router.push({path:"/digital-list"})):a.$message.error(t.data.message)})}})}},components:{"city-choose":e("LcFk").a,"footer-temp":s.a}},o={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"xym",attrs:{id:"DigitalAddResult"}},[e("div",{staticClass:"bread-nav"},[e("span",{on:{click:function(a){return t.$router.push("/digital-list")}}},[t._v("数字防疫点")]),t._v(" "),e("em",[t._v("/ 添加防疫点")])]),t._v(" "),e("div",{staticClass:"x-container"},[e("div",{staticClass:"la-result",staticStyle:{"margin-top":"30px"}},[e("el-form",{ref:"laForm",attrs:{model:t.ruleForm,rules:t.rules}},[e("div",{staticClass:"digital-detail-basic"},[e("div",{staticClass:"xtitle-heading"},[e("div",{staticClass:"xtitle-heading-h"},[e("div",{staticClass:"xtitle-heading-h-line"}),t._v(" "),e("div",{staticClass:"xtitle-heading-h-p"},[t._v("基本信息")])])]),t._v(" "),e("div",{staticClass:"digital-detail-basic-content"},[e("div",{staticClass:"lar-con clearfix"},[e("el-form-item",{staticClass:"lar-box clearfix",attrs:{prop:"epedName"}},[e("div",{staticClass:"lar-box-h4"},[e("span",{staticClass:"dia-citem-label-must"},[t._v("*")]),t._v("防疫点名称")]),t._v(" "),e("div",{staticClass:"lar-box-el-input"},[e("el-input",{attrs:{maxlength:"100",placeholder:"请输入防疫点名称",size:"small"},model:{value:t.ruleForm.epedName,callback:function(a){t.$set(t.ruleForm,"epedName",a)},expression:"ruleForm.epedName"}})],1)]),t._v(" "),e("el-form-item",{staticClass:"lar-box",attrs:{prop:"inNum"}},[e("div",{staticClass:"lar-box-h4"},[e("span",{staticClass:"dia-citem-label-must"},[t._v("*")]),t._v("内部编号")]),t._v(" "),e("div",{staticClass:"lar-box-el-input"},[e("el-input",{attrs:{maxlength:"100",placeholder:"请输入防疫点内部编号",size:"small"},model:{value:t.ruleForm.inNum,callback:function(a){t.$set(t.ruleForm,"inNum",a)},expression:"ruleForm.inNum"}})],1)]),t._v(" "),e("el-form-item",{staticClass:"lar-box",attrs:{prop:"areaCode"}},[e("div",{staticClass:"lar-box-h4"},[e("span",{staticClass:"dia-citem-label-must"},[t._v("*")]),t._v("区域")]),t._v(" "),e("div",{staticClass:"lar-box-el-input"},[e("city-choose",{ref:"cityChooseRef",attrs:{selectCity:t.special.areaCode},on:{childVal:t.getCity}})],1)]),t._v(" "),e("el-form-item",{staticClass:"lar-box",attrs:{prop:"address"}},[e("div",{staticClass:"lar-box-h4"},[e("span",{staticClass:"dia-citem-label-must"},[t._v("*")]),t._v("详细地址")]),t._v(" "),e("div",{staticClass:"lar-box-el-input"},[e("el-input",{attrs:{maxlength:"100",size:"small",id:"address",placeholder:"请输入详细地址"},model:{value:t.ruleForm.address,callback:function(a){t.$set(t.ruleForm,"address",a)},expression:"ruleForm.address"}})],1)])],1),t._v(" "),e("div",{staticClass:"map-box"},[e("div",{attrs:{id:"map-container"}})])])]),t._v(" "),e("div",{staticClass:"digital-detail-checkArea"},[e("div",{staticClass:"xtitle-heading"},[e("div",{staticClass:"xtitle-heading-h"},[e("div",{staticClass:"xtitle-heading-h-line"}),t._v(" "),e("div",{staticClass:"xtitle-heading-h-p"},[t._v("检测区域（"+t._s(t.checkPoint.length)+"）")])])]),t._v(" "),e("div",{staticClass:"digital-detail-checkArea-content clearfix"},[t._l(t.checkPoint,function(a,i){return e("div",{key:i,staticClass:"dd-checkArea-box"},[e("div",{staticClass:"dd-checkArea-box-close",on:{click:function(a){return t.checkPointDelete(i)}}}),t._v(" "),e("div",{staticClass:"ddcarea-item"},[e("div",{staticClass:"ddcarea-item-label"},[e("span",{staticClass:"dia-citem-label-must"},[t._v("*")]),t._v("检测区域名称")]),t._v(" "),e("div",{staticClass:"ddcarea-item-input"},[e("el-input",{attrs:{maxlength:"50",size:"small"},model:{value:a.pointName,callback:function(e){t.$set(a,"pointName",e)},expression:"item.pointName"}})],1)]),t._v(" "),e("div",{staticClass:"ddcarea-item"},[e("div",{staticClass:"ddcarea-item-label"},[e("span",{staticClass:"dia-citem-label-must"},[t._v("*")]),t._v("可测量数据")]),t._v(" "),e("div",{staticClass:"ddcarea-item-input"},[e("el-dropdown",{staticStyle:{width:"100%"},attrs:{trigger:"click"}},[e("span",{staticClass:"el-dropdown-link"},[e("div",{staticStyle:{position:"absolute",top:"5px",right:"10px","z-index":"10"}},[e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),e("el-input",{staticClass:"ddcarea-item-input-cn",attrs:{size:"small",placeholder:"请选择部件"},model:{value:a.pointDataCN,callback:function(e){t.$set(a,"pointDataCN",e)},expression:"item.pointDataCN"}})],1),t._v(" "),e("el-dropdown-menu",{staticStyle:{width:"260px"},attrs:{slot:"dropdown"},slot:"dropdown"},[e("div",{staticClass:"checkPoint-dropdown"},[e("el-checkbox-group",{on:{change:function(a){return t.listPointDataChange(i)}},model:{value:a.pointData,callback:function(e){t.$set(a,"pointData",e)},expression:"item.pointData"}},t._l(t.pointDataOptions,function(a){return e("el-checkbox",{key:a.value,staticStyle:{display:"block !important","margin-left":"0px !important","margin-top":"10px"},attrs:{label:a.value}},[t._v(t._s(a.label))])}),1)],1)])],1)],1)])])}),t._v(" "),e("div",{staticClass:"dd-checkArea-box",staticStyle:{cursor:"pointer"},on:{click:t.openDialogAddCheckPoint}},[e("div",{staticClass:"add-check-point"},[e("div",{staticClass:"add-check-point-img"}),t._v(" "),e("div",{staticClass:"add-check-point-p"},[t._v("添加区域")])])])],2)]),t._v(" "),e("div",{staticClass:"xlist-btn-con clearfix"},[e("div",{staticClass:"xlist-btn xlist-btn-submit",staticStyle:{float:"left"},on:{click:t.submit}},[t._v("保存")]),t._v(" "),e("div",{staticClass:"xlist-btn xlist-btn-cancel",staticStyle:{float:"left","margin-left":"40px"},on:{click:function(a){return t.$router.push("/digital-list")}}},[t._v("取消")])])])],1)]),t._v(" "),e("el-dialog",{attrs:{visible:t.dialogAddCheckPoint,title:"添加检测区域","show-close":!1,width:"700px"},on:{"update:visible":function(a){t.dialogAddCheckPoint=a}}},[e("div",{staticClass:"dia-content"},[e("el-form",{ref:"checkPointRef",staticClass:"diaForm",attrs:{model:t.ruleFormCheckPoint,rules:t.rulesCheckPoint}},[e("div",{staticClass:"dia-clist"},[e("div",{staticClass:"dia-citem"},[e("div",{staticClass:"dia-citem-label"},[e("span",{staticClass:"dia-citem-label-must"},[t._v("*")]),t._v("检测区域名称")]),t._v(" "),e("div",{staticClass:"dia-citem-ib"},[e("el-input",{attrs:{maxlength:"50",size:"small",placeholder:"请输入部件名称"},model:{value:t.ruleFormCheckPoint.pointName,callback:function(a){t.$set(t.ruleFormCheckPoint,"pointName",a)},expression:"ruleFormCheckPoint.pointName"}})],1)]),t._v(" "),e("div",{staticClass:"dia-citem"},[e("div",{staticClass:"dia-citem-label"},[e("span",{staticClass:"dia-citem-label-must"},[t._v("*")]),t._v("可测量数据（多选）")]),t._v(" "),e("div",{staticClass:"dia-citem-ib"},[e("el-dropdown",{staticStyle:{width:"100%"},attrs:{trigger:"click"}},[e("span",{staticClass:"el-dropdown-link"},[e("div",{staticStyle:{position:"absolute",top:"5px",right:"10px","z-index":"10"}},[e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),e("el-input",{attrs:{size:"small",placeholder:"请选择可测量数据"},model:{value:t.ruleFormCheckPoint.pointDataCN,callback:function(a){t.$set(t.ruleFormCheckPoint,"pointDataCN",a)},expression:"ruleFormCheckPoint.pointDataCN"}})],1),t._v(" "),e("el-dropdown-menu",{staticStyle:{width:"640px"},attrs:{slot:"dropdown"},slot:"dropdown"},[e("div",{staticClass:"checkPoint-dropdown"},[e("el-checkbox-group",{on:{change:t.formPointDataChange},model:{value:t.checkPointDataArr,callback:function(a){t.checkPointDataArr=a},expression:"checkPointDataArr"}},t._l(t.pointDataOptions,function(a){return e("el-checkbox",{key:a.value,staticStyle:{display:"block !important","margin-left":"0px !important","margin-top":"10px"},attrs:{label:a.value}},[t._v(t._s(a.label))])}),1)],1)])],1)],1)])])]),t._v(" "),e("div",{staticClass:"dia-btn-con",staticStyle:{"text-align":"right"}},[e("div",{staticClass:"dia-btn dia-btn-cancel",on:{click:t.closeDialogAddCheckPoint}},[t._v("取消")]),t._v(" "),e("div",{staticClass:"dia-btn dia-btn-submit",on:{click:t.saveCheckPoint}},[t._v("完成")])])],1)])],1)},staticRenderFns:[]};var n=e("VU/8")(l,o,!1,function(t){e("SCiK"),e("wdyg")},"data-v-01bf88ed",null);a.default=n.exports},wdyg:function(t,a){}});