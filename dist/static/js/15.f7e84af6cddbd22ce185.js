webpackJsonp([15],{"0TUx":function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=a("n5Qe"),e={data:function(){return{dialogBatch:!1,upfile:"",upFileForwardFlag:"",diaLoading:!1,batchRes:{},dialogBatchResult:!1}},mounted:function(){},methods:{openSubmitFile:function(){this.diaLoading=!1,this.upfile="",this.upFileForwardFlag="",this.dialogBatch=!0,setTimeout(function(){document.getElementById("liftInputFile").value=""},200)},deleteUpfileForward:function(){this.upfile="",this.upFileForwardFlag="",setTimeout(function(){document.getElementById("liftInputFile").value=""},200)},changeUpfile:function(){var t=document.getElementById("liftInputFile"),i=t.files[0].name,a=i.substr(i.lastIndexOf("."));".xls"==a||".xlsx"==a?(this.upfile=t.files[0],this.upFileForwardFlag="success"):(this.upfile=t.files[0],this.upFileForwardFlag="error")},submitFile:function(){var t=this;if(""===this.upFileForwardFlag||"error"==this.upFileForwardFlag)return this.$message.error("请上传Excel文件");var i=document.getElementById("liftInputFile"),a=new FormData;a.append("file",i.files[0]),this.diaLoading=!0,s.a.log.batchAddLift(a).then(function(i){t.diaLoading=!1,t.batchRes=i.data.data,t.dialogBatch=!1,t.dialogBatchResult=!0}).catch(function(i){t.diaLoading=!1})},downloadError:function(){if(0===this.batchRes.failCnt)return this.$message.info("无错误日志");var t=http.localURL+"/arctic/download/file?fileName="+this.batchRes.fileName;window.open(t)}}},l={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",[a("button",{staticClass:"btn whiteBtn",on:{click:t.openSubmitFile}},[t._v("批量导入")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.diaLoading,expression:"diaLoading"}],staticClass:"dia-loading"},[a("div",{staticClass:"dia-loading-p"},[t._v("导入时间较长，请耐心等待...")])]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogBatch,title:"批量导入","show-close":!1,width:"690px"},on:{"update:visible":function(i){t.dialogBatch=i}}},[a("div",[a("div",{staticClass:"dia-content"},[a("div",{staticClass:"dia-clist"},[a("div",{staticClass:"dia-citem clearfix"},[a("div",{staticClass:"dia-citem-label"},[t._v("下载模板：")]),t._v(" "),a("div",{staticClass:"dia-citem-ib"},[a("a",{staticClass:"dia-download-link",attrs:{href:"https://iot.gidomino.com/elevator/template/batch-import-template-property.xlsx",target:"_blank"}},[t._v("《电梯管理批量导入-模板.excel》")])])]),t._v(" "),a("div",{staticClass:"dia-citem clearfix",staticStyle:{"margin-top":"10px"}},[a("div",{staticClass:"dia-citem-label"},[t._v("上传文件：")]),t._v(" "),a("div",{staticClass:"dia-citem-ib"},[a("div",{staticClass:"dia-upload-icon"},[a("div",{staticClass:"dia-upload-icon-p1"},[t._v("点击上传文件")]),t._v(" "),a("div",{staticClass:"dia-upload-icon-p2"},[t._v("请按模板填写")]),t._v(" "),a("input",{staticClass:"dia-upfile",attrs:{id:"liftInputFile",name:"file",type:"file",value:""},on:{change:t.changeUpfile}})])])]),t._v(" "),a("div",{staticClass:"dia-citem clearfix",staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"dia-citem-label"},[t._v("已上传：")]),t._v(" "),a("div",{staticClass:"dia-citem-ib"},[""!==t.upfile?a("div",{staticClass:"dia-upload-list clearfix"},[a("div",{staticClass:"dia-upload-list-icon",class:"error"==t.upFileForwardFlag?"upFileForwardError":""}),t._v(" "),a("div",{staticClass:"dia-upload-list-p"},[a("div",{staticClass:"dia-upload-list-p-name",class:"error"==t.upFileForwardFlag?"upFileForwardError":""},[t._v(t._s(this.upfile.name))]),t._v(" "),"error"==t.upFileForwardFlag?a("div",{staticClass:"dia-upload-list-p-error"},[t._v("上传失败，请检查文件有效性后重新上传")]):t._e()]),t._v(" "),a("div",{staticClass:"dia-upload-list-del",on:{click:t.deleteUpfileForward}})]):t._e()])])])]),t._v(" "),a("div",{staticClass:"dia-btn-con",staticStyle:{"margin-top":"30px"}},[a("input",{staticClass:"dia-btn dia-btn-cancel",attrs:{type:"button",value:"取消"},on:{click:function(i){t.dialogBatch=!1}}}),t._v(" "),a("input",{staticClass:"dia-btn dia-btn-submit",attrs:{type:"button",value:"确认"},on:{click:t.submitFile}})])])]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogBatchResult,title:"提示","show-close":!1,width:"690px"},on:{"update:visible":function(i){t.dialogBatchResult=i}}},[a("div",[a("div",{staticClass:"dia-content"},[a("div",{staticClass:"batch-result"},[a("div",{staticClass:"batch-result-item"},[a("div",{staticClass:"batch-result-item-title success"},[t._v("导入成功")]),t._v(" "),a("div",{staticClass:"batch-result-item-p"},[t._v("\n              成功导入"),a("span",{staticClass:"batch-result-p-info"},[t._v(t._s(t.batchRes.successCnt)+"部")]),t._v("电梯！其中，存在"),a("span",{staticClass:"batch-result-p-error"},[t._v(t._s(t.batchRes.paramIncompleteCnt)+"部")]),t._v("电梯需要补充材料；存在"),a("span",{staticClass:"batch-result-p-error"},[t._v(t._s(t.batchRes.otherBrandCnt)+"部")]),t._v("电梯品牌未匹配，暂定电梯品牌为「其他」\n            ")])]),t._v(" "),a("div",{staticClass:"batch-result-item",staticStyle:{"margin-top":"36px"}},[a("div",{staticClass:"batch-result-item-title"},[t._v("导入失败")]),t._v(" "),a("div",{staticClass:"batch-result-item-p"},[t._v("\n              导入失败"+t._s(t.batchRes.failCnt)+"部电梯，可下载错误日志，查看失败原因。\n            ")])])])]),t._v(" "),a("div",{staticClass:"diaN-btn-con clearfix",staticStyle:{"margin-top":"30px"}},[a("div",{staticClass:"diaN-btn diaN-btn-cancel",on:{click:function(i){t.dialogBatchResult=!1}}},[t._v("好的")]),t._v(" "),a("div",{staticClass:"diaN-btn diaN-btn-red",on:{click:t.downloadError}},[t._v("下载错误日志")])])])])],1)},staticRenderFns:[]};var c=a("VU/8")(e,l,!1,function(t){a("CLy7")},"data-v-a0ebc8da",null);i.default=c.exports},CLy7:function(t,i){}});