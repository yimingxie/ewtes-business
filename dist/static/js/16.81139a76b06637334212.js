webpackJsonp([16],{"KY+s":function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("n5Qe"),s=e("EBA8"),l=e("TCsi"),d=e("s6tw"),n=e("QOnF"),r=(e("XAb4"),{data:function(){return{parentCode:"",epedName:"",inNum:"",localArea:"",address:"",parentName:"",parentNameShow:"",diagnList:[],test:"",liftselevCodeOptions:[],checkedLifts:[],checkedAll:!1,diagnParams:{epId:"",limit:10,offset:1,search:"",status:"-1"},statusItem:[{label:"全部",value:-1},{label:"启用",value:1},{label:"停用",value:0}],statusValue:-1,currentPage:1,totalPage:1,pageSize:10,dialogAddDiagnTitle:"添加监测应用",dialogAddDiagn:!1,ruleFormAddDiagn:{name:"名称",epId:"防疫点Id",observTaskId:"检测任务ID",operator:3,value:38,error:.5},rulesAddDiagn:{name:[{required:!0,message:"必填",trigger:"blur"}],observTaskId:[{required:!0,message:"必填",trigger:"change"}],operator:[{required:!0,message:"必填",trigger:"change"}],value:[{required:!0,message:"必填",trigger:"blur"}],error:[{required:!0,message:"必填",trigger:"blur"}]},observTaskOptions:[],currentDiagnId:"",operatorOptions:[{label:"≥",value:3},{label:"≤",value:4},{label:"=",value:0},{label:"≠",value:5}],dialogDeleteDiagn:!1}},created:function(){this.parentCode=this.$route.query.epedId,this.diagnParams.epId=this.$route.query.epedId},mounted:function(){var a=this;this.getDiagnList(),this.getDigitalDetail(),this.getObservTaskOptions();var t=this.$refs.parentRef;setTimeout(function(){a.parentNameShow=t.clientWidth<t.scrollWidth},300),window.addEventListener("resize",function(){a.parentNameShow=t.clientWidth<t.scrollWidth})},methods:{getDiagnList:function(){var a=this;i.a.digital.getDiagnosisList(this.diagnParams).then(function(t){a.diagnList=t.data.data.records,a.liftselevCodeOptions=[],a.diagnList.forEach(function(t){a.liftselevCodeOptions.push(t.id)}),a.currentPage=t.data.data.current,a.totalPage=t.data.data.total})},getObservTaskOptions:function(){var a=this;i.a.digital.getUnusedTask(this.parentCode).then(function(t){var e=t.data.data||[];a.observTaskOptions=[],0!==e.length&&e.forEach(function(t){a.observTaskOptions.push({label:t.name,value:t.id})})})},getDigitalDetail:function(){var a=this;i.a.digital.getDigitalDetail(this.parentCode).then(function(t){var e=t.data.data;a.epedName=e.epedName,a.inNum=e.inNum,a.localArea=e.localArea,a.address=e.address,a.parentName=e.parentName})},checkedLiftsChange:function(a){var t=this.diagnList.length;this.checkedAll=a.length===t},checkedAllChange:function(a){this.checkedLifts=a?this.liftselevCodeOptions:[]},currentPageChange:function(a){this.diagnParams.offset=a,this.getDiagnList()},pageSizeChange:function(a){this.diagnParams.limit=a,this.getDiagnList()},searchTask:function(a){this.diagnParams.search=a,this.diagnParams.offset=1,this.getDiagnList()},clearTask:function(){this.diagnParams.search="",this.diagnParams.offset=1,this.getDiagnList()},openDialogAddDiagn:function(){this.getObservTaskOptions(),this.dialogAddDiagnTitle="添加监测应用",this.ruleFormAddDiagn={name:"",epedId:this.parentCode,observTaskId:"",operator:"",value:"",error:""},this.dialogAddDiagn=!0},submitAddDiagn:function(){var a=this;this.$refs.addDiagnRef.validate(function(t){if(t){var e={name:a.ruleFormAddDiagn.name,epedId:a.parentCode,observeTaskId:a.ruleFormAddDiagn.observTaskId,operator:a.ruleFormAddDiagn.operator,value:a.ruleFormAddDiagn.value,errValue:a.ruleFormAddDiagn.error};i.a.digital.addDiagnosis(e).then(function(t){200==t.data.code?(a.$message.success("添加成功"),a.closeDialogDiagn(),a.getDiagnList()):a.$message.error(t.data.message)})}})},openDialogEditDiagn:function(a,t,e){var s=this;i.a.digital.getUnusedTask(this.parentCode).then(function(l){var d=l.data.data||[];s.observTaskOptions=t?[{label:e,value:t}]:[],d.forEach(function(a){s.observTaskOptions.push({label:a.name,value:a.id})}),i.a.digital.getDiagnosis(a).then(function(a){var t=a.data.data;s.dialogAddDiagn=!0,s.currentDiagnId=t.id,s.dialogAddDiagnTitle="编辑监测应用",s.ruleFormAddDiagn={name:t.name,epId:s.parentCode,observTaskId:t.observeTaskId,operator:parseInt(t.operator),value:t.value,error:t.errValue}})})},submitEditDiagn:function(){var a=this;this.$refs.addDiagnRef.validate(function(t){if(t){var e={id:a.currentDiagnId,name:a.ruleFormAddDiagn.name,observeTaskId:a.ruleFormAddDiagn.observTaskId,operator:a.ruleFormAddDiagn.operator,value:a.ruleFormAddDiagn.value,errValue:a.ruleFormAddDiagn.error};i.a.digital.editDiagnosis(e).then(function(t){200==t.data.code?(a.$message.success("编辑成功"),a.closeDialogDiagn(),a.currentDiagnId="",a.getDiagnList()):a.$message.error(t.data.message)})}})},closeDialogDiagn:function(){this.$refs.addDiagnRef.clearValidate(),this.dialogAddDiagn=!1,this.currentDiagnId=""},openDialogDeleteDiagn:function(){if(0===this.checkedLifts.length)return this.$message.error("请选择要删除的监测应用");this.dialogDeleteDiagn=!0},deleteDiagn:function(){var a=this,t={ids:this.checkedLifts};i.a.digital.deleteDiagnosis(t).then(function(t){200==t.data.code?(a.$message.success("删除成功"),a.dialogDeleteDiagn=!1,a.checkedAll=!1,a.checkedLifts=[],a.getDiagnList()):(a.$message.error(t.data.message),a.dialogDeleteDiagn=!1)})},switchChange:function(a,t){var e=this,s={id:t,enable:a};i.a.digital.switchDiagnosis(s).then(function(a){e.$message.success("成功")})}},watch:{statusValue:function(a,t){this.diagnParams.status=a,this.diagnParams.offset=1,this.getDiagnList()}},filters:{splitEpedName:function(a){return"string"==typeof a&&a.length>=10?a.substring(0,8)+"...":a}},components:{"city-choose2":n.a,"search-input":l.a,"footer-temp":d.a,"radio-group":s.a}}),c={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"xym",attrs:{id:"DiagnosisList"}},[e("div",{staticClass:"bread-nav"},[e("span",{on:{click:function(t){return a.$router.push("/digital-list")}}},[a._v("数字防疫点")]),a._v(" "),e("span",{on:{click:function(t){return a.$router.go(-1)}}},[a._v("/ 档案")]),a._v(" "),e("em",[a._v("/ 监测应用管理")])]),a._v(" "),e("div",{staticClass:"x-container"},[e("div",{staticClass:"x-digital-detail clearfix"},[e("div",{staticClass:"xddetail-name"},[e("div",{staticClass:"xddetail-name-p"},[a._v(a._s(a._f("splitEpedName")(a.epedName)))]),a._v(" "),a.epedName.length>=10?e("div",{staticClass:"xddetail-name-p-full"},[a._v(a._s(a.epedName))]):a._e()]),a._v(" "),e("div",{staticClass:"xddetail-list clearfix"},[e("div",{staticClass:"xddetail-list-item-first clearfix"},[e("div",{staticClass:"xddetail-list-item clearfix",staticStyle:{width:"100%"}},[e("div",{staticClass:"xddetail-list-item-title"},[a._v("内部编号")]),a._v(" "),e("div",{staticClass:"xddetail-list-item-p xddetail-list-item-p-parent"},[a._v(a._s(a.inNum))])])]),a._v(" "),e("div",{staticClass:"xddetail-list-item-second clearfix"},[e("div",{staticClass:"xddetail-list-item clearfix"},[e("div",{staticClass:"xddetail-list-item-title"},[a._v("区域")]),a._v(" "),e("div",{staticClass:"xddetail-list-item-p"},[a._v(a._s(a.localArea))])]),a._v(" "),e("div",{staticClass:"xddetail-list-item clearfix"},[e("div",{staticClass:"xddetail-list-item-title"},[a._v("详细地址")]),a._v(" "),e("div",{staticClass:"xddetail-list-item-p",staticStyle:{"padding-right":"0"}},[a._v(a._s(a.address))])])]),a._v(" "),e("div",{staticClass:"xddetail-list-item-third clearfix"},[e("div",{staticClass:"xddetail-list-item clearfix"},[e("div",{staticClass:"xddetail-list-item-title"},[a._v("所属上级")]),a._v(" "),e("div",{ref:"parentRef",staticClass:"xddetail-list-item-p xddetail-list-item-p-parent",staticStyle:{"padding-right":"0"}},[a._v("\n              "+a._s(a.parentName?a.parentName:"--")+"\n              "),a.parentNameShow?e("div",{staticClass:"xddetail-name-p-full"},[a._v(a._s(a.parentName))]):a._e()])])])])]),a._v(" "),e("div",{staticClass:"x-list"},[e("div",{staticClass:"xlist-choose clearfix"},[e("radio-group",{staticStyle:{"margin-top":"5px",float:"left"},attrs:{items:a.statusItem,value:a.statusValue},on:{"update:value":function(t){a.statusValue=t}}},[e("span",{attrs:{slot:"label"},slot:"label"},[a._v("状态：")])]),a._v(" "),e("div",{staticClass:"xlist-choose-si"},[e("search-input",{ref:"searchInputRef",attrs:{placeholderValue:"搜索监测应用名称"},on:{search:a.searchTask,cancel:a.clearTask}})],1)],1),a._v(" "),e("div",{staticClass:"xlist-operator"},[e("div",{staticClass:"xlist-operator-content clearfix"},[e("div",{staticClass:"xop-btn-submit",on:{click:a.openDialogAddDiagn}},[a._v("添加监测应用")]),a._v(" "),e("div",{staticClass:"xop-btn-delete",on:{click:a.openDialogDeleteDiagn}},[a._v("删除应用")])])]),a._v(" "),e("div",{staticClass:"x-list-block"}),a._v(" "),e("div",{staticClass:"ll-table"},[e("div",{staticClass:"llt-thead"},[e("div",{staticClass:"llt-tr clearfix"},[e("div",{staticClass:"llt-th"},[e("el-checkbox",{on:{change:a.checkedAllChange},model:{value:a.checkedAll,callback:function(t){a.checkedAll=t},expression:"checkedAll"}},[a._v(a._s(a.test))])],1),a._v(" "),e("div",{staticClass:"llt-th"},[a._v("监测应用名称")]),a._v(" "),e("div",{staticClass:"llt-th"},[a._v("已关联检测任务(id)")]),a._v(" "),e("div",{staticClass:"llt-th"},[a._v("阈值判断类型")]),a._v(" "),e("div",{staticClass:"llt-th"},[a._v("阈值")]),a._v(" "),e("div",{staticClass:"llt-th"},[a._v("容错范围")]),a._v(" "),e("div",{staticClass:"llt-th"},[a._v("状态")]),a._v(" "),e("div",{staticClass:"llt-th"},[a._v("操作")])])]),a._v(" "),e("div",{staticClass:"llt-tbody"},[e("div",{directives:[{name:"show",rawName:"v-show",value:0==a.diagnList.length,expression:"diagnList.length == 0"}],staticClass:"list-no-data"},[a._v("暂无数据")]),a._v(" "),a._l(a.diagnList,function(t,i){return e("div",{key:t.id,staticClass:"llt-tr clearfix",class:t.enable?"":"offline"},[e("div",{staticClass:"llt-tr-container clearfix"},[e("div",{staticClass:"llt-td"},[e("el-checkbox-group",{on:{change:a.checkedLiftsChange},model:{value:a.checkedLifts,callback:function(t){a.checkedLifts=t},expression:"checkedLifts"}},[e("el-checkbox",{key:i,attrs:{label:t.id}},[a._v(a._s(a.test))])],1)],1),a._v(" "),e("div",{staticClass:"llt-td"},[a._v(a._s(t.name))]),a._v(" "),e("div",{staticClass:"llt-td"},[t.observeTaskId?e("div",{staticClass:"over-el"},[a._v(a._s(t.taskName)+"("+a._s(t.observeTaskId)+")")]):e("div",[a._v("--")])]),a._v(" "),e("div",{staticClass:"llt-td"},[a._v(a._s(a._f("returnOperatorCN")(t.operator)))]),a._v(" "),e("div",{staticClass:"llt-td"},[a._v(a._s(t.value))]),a._v(" "),e("div",{staticClass:"llt-td"},[a._v(a._s(t.errValue))]),a._v(" "),e("div",{staticClass:"llt-td"},[e("div",{staticClass:"ll-table-switch"},[e("el-switch",{attrs:{"active-color":"#E2E6E8","inactive-color":"#E3E7E9","active-value":1,"inactive-value":0,width:28},on:{change:function(e){return a.switchChange(e,t.id)}},model:{value:t.enable,callback:function(e){a.$set(t,"enable",e)},expression:"item.enable"}})],1)]),a._v(" "),e("div",{staticClass:"llt-td"},[e("span",{staticClass:"llt-td-a",on:{click:function(e){return a.openDialogEditDiagn(t.id,t.observeTaskId,t.taskName)}}},[a._v("编辑")])])])])})],2),a._v(" "),e("div",{staticClass:"list-page"},[e("el-pagination",{attrs:{"current-page":a.currentPage,"page-sizes":[10,20,30],"page-size":a.pageSize,layout:"prev, pager, next, sizes, jumper",total:a.totalPage},on:{"size-change":a.pageSizeChange,"current-change":a.currentPageChange}})],1)])])]),a._v(" "),e("el-dialog",{attrs:{visible:a.dialogAddDiagn,title:a.dialogAddDiagnTitle,"show-close":!1,width:"700px"},on:{"update:visible":function(t){a.dialogAddDiagn=t},close:a.closeDialogDiagn}},[e("div",{staticClass:"dia-content"},[e("el-form",{ref:"addDiagnRef",staticClass:"diaForm",attrs:{model:a.ruleFormAddDiagn,rules:a.rulesAddDiagn}},[e("div",{staticClass:"dia-clist"},[e("div",{staticClass:"dia-citem"},[e("el-form-item",{attrs:{prop:"name"}},[e("div",{staticClass:"dia-citem-label"},[e("span",{staticClass:"dia-citem-label-must"},[a._v("*")]),a._v("监测应用名称：")]),a._v(" "),e("div",{staticClass:"dia-citem-ib"},[e("el-input",{attrs:{maxlength:"50",size:"small",placeholder:"请输入名称"},model:{value:a.ruleFormAddDiagn.name,callback:function(t){a.$set(a.ruleFormAddDiagn,"name",t)},expression:"ruleFormAddDiagn.name"}})],1)])],1),a._v(" "),e("div",{staticClass:"dia-citem"},[e("el-form-item",{attrs:{prop:"observTaskId"}},[e("div",{staticClass:"dia-citem-label"},[e("span",{staticClass:"dia-citem-label-must"},[a._v("*")]),a._v("检测任务：")]),a._v(" "),e("div",{staticClass:"dia-citem-ib"},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择检测任务",size:"small"},model:{value:a.ruleFormAddDiagn.observTaskId,callback:function(t){a.$set(a.ruleFormAddDiagn,"observTaskId",t)},expression:"ruleFormAddDiagn.observTaskId"}},a._l(a.observTaskOptions,function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})}),1)],1)])],1),a._v(" "),e("div",{staticClass:"dia-citem"},[e("el-form-item",{attrs:{prop:"operator"}},[e("div",{staticClass:"dia-citem-label"},[e("span",{staticClass:"dia-citem-label-must"},[a._v("*")]),a._v("阈值判断类型")]),a._v(" "),e("div",{staticClass:"dia-citem-ib"},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择阈值判断类型",size:"small"},model:{value:a.ruleFormAddDiagn.operator,callback:function(t){a.$set(a.ruleFormAddDiagn,"operator",t)},expression:"ruleFormAddDiagn.operator"}},a._l(a.operatorOptions,function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})}),1)],1)])],1),a._v(" "),e("div",{staticClass:"dia-citem"},[e("el-form-item",{attrs:{prop:"value"}},[e("div",{staticClass:"dia-citem-label"},[e("span",{staticClass:"dia-citem-label-must"},[a._v("*")]),a._v("阈值：")]),a._v(" "),e("div",{staticClass:"dia-citem-ib"},[e("el-input",{attrs:{size:"small",placeholder:"请输入阈值"},model:{value:a.ruleFormAddDiagn.value,callback:function(t){a.$set(a.ruleFormAddDiagn,"value",t)},expression:"ruleFormAddDiagn.value"}})],1)])],1),a._v(" "),e("div",{staticClass:"dia-citem"},[e("el-form-item",{attrs:{prop:"error"}},[e("div",{staticClass:"dia-citem-label"},[e("span",{staticClass:"dia-citem-label-must"},[a._v("*")]),a._v("容错范围：")]),a._v(" "),e("div",{staticClass:"dia-citem-ib"},[e("el-input",{attrs:{size:"small",placeholder:"请输入容错值"},model:{value:a.ruleFormAddDiagn.error,callback:function(t){a.$set(a.ruleFormAddDiagn,"error",t)},expression:"ruleFormAddDiagn.error"}})],1)])],1)])]),a._v(" "),"添加监测应用"==a.dialogAddDiagnTitle?e("div",{staticClass:"dia-btn-con",staticStyle:{"text-align":"right"}},[e("div",{staticClass:"dia-btn dia-btn-cancel",on:{click:a.closeDialogDiagn}},[a._v("取消")]),a._v(" "),e("div",{staticClass:"dia-btn dia-btn-submit",on:{click:a.submitAddDiagn}},[a._v("完成")])]):e("div",{staticClass:"dia-btn-con",staticStyle:{"text-align":"right"}},[e("div",{staticClass:"dia-btn dia-btn-cancel",on:{click:a.closeDialogDiagn}},[a._v("取消")]),a._v(" "),e("div",{staticClass:"dia-btn dia-btn-submit",on:{click:a.submitEditDiagn}},[a._v("完成")])])],1)]),a._v(" "),e("el-dialog",{attrs:{visible:a.dialogDeleteDiagn,title:"删除监测应用","show-close":!1,width:"700px"},on:{"update:visible":function(t){a.dialogDeleteDiagn=t}}},[e("div",{staticClass:"dia-content"},[e("div",{staticClass:"dia-con-p"},[e("h4",[a._v("是否确认删除")])]),a._v(" "),e("div",{staticClass:"dia-btn-con",staticStyle:{"text-align":"right"}},[e("div",{staticClass:"dia-btn dia-btn-cancel",on:{click:function(t){a.dialogDeleteDiagn=!1}}},[a._v("取消")]),a._v(" "),e("div",{staticClass:"dia-btn dia-btn-submit",on:{click:a.deleteDiagn}},[a._v("确认")])])])])],1)},staticRenderFns:[]};var o=e("VU/8")(r,c,!1,function(a){e("w6T1")},"data-v-44aadfdd",null);t.default=o.exports},w6T1:function(a,t){}});